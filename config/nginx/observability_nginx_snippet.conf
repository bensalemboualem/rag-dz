    # =====================================================
    # OBSERVABILITY STACK - Grafana, Prometheus
    # =====================================================

    # Grafana Dashboard
    location /grafana {
        rewrite ^/grafana$ /grafana/ permanent;
    }
    location /grafana/ {
        proxy_pass http://127.0.0.1:3033/;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }

    # Prometheus (protected - internal only via Grafana)
    location /prometheus/ {
        # Basic auth protection
        auth_basic "Prometheus Admin";
        auth_basic_user_file /etc/nginx/.htpasswd_monitoring;
        
        proxy_pass http://127.0.0.1:9090/;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # Alertmanager (protected)
    location /alertmanager/ {
        auth_basic "Alertmanager Admin";
        auth_basic_user_file /etc/nginx/.htpasswd_monitoring;
        
        proxy_pass http://127.0.0.1:9093/;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

